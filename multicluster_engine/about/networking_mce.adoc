[#networking-mce]
= Networking

Learn about network requirements for the {mce} hub cluster and managed clusters.

* <<hub-network-config-mce,Hub cluster network configuration>>
* <<managed-network-config-mce,Managed cluster network configuration>>
* <<network-configuration-infra-operator-mce,Additional networking requirements when installing using the infrastructure operator>>
* <<network-configuration-hive-mce,Additional networking requirements when installing using the Hive Operator>>
* <<network-configuration-hosted-control-planes-mce,Hosted control planes networking requirements (Technology Preview)>>

[#hub-network-config-mce]
== Hub cluster network configuration

You can refer to the configuration for your hub cluster network.

See the hub cluster network requirements in the following table:

|===
| Direction | Connection | Port (if specified)

| Outbound
| API of the cloud provider
| 

| Outbound
| (Optional) Kubernetes API server of the provisioned managed cluster
| 6443

| Outbound and inbound
| The `WorkManager` service route on the managed cluster
| 443

| Inbound
| The Kubernetes API server of the multicluster engine for Kubernetes cluster from the managed cluster
| 6443

|===

[#managed-network-config-mce]
== Managed cluster network configuration

For the managed cluster networking requirements, see the following table:

|===
| Direction | Connection | Port (if specified)

| Outbound and inbound
| Kubernetes API server of the multicluster engine for Kubernetes cluster
| 6443

|===

[#network-configuration-infra-operator-mce]
== Additional networking requirements when installing using the infrastructure operator

When you are installing bare metal managed clusters with the Infrastructure Operator, see the following table for the additional networking requirements:

|===
| Direction | Protocol | Connection | Port (if specified)

| Hub cluster outbound to the ISO/rootfs image repository
| HTTPS (HTTP in a disconnected environment
| Used to create an ISO image on the {product-title-short} hub
| 443 (80 in disconnected environments)

| Hub cluster outbound to BMC interface at single node {ocp-short} managed cluster
| HTTPS (HTTP in disconnected environment)
| Boot the {ocp-short} cluster
| 443

| Outbound from the {ocp-short} managed cluster to the hub cluster
| HTTPS
| Reports hardware information using the `assistedService` route 
| 443

| Outbound from the {ocp-short} managed cluster to the ISO/rootfs image repository
| HTTP
| Downloads the rootfs image
| 80

| Outbound from the {ocp-short} managed cluster to the quay.io image repository
| HTTPS/TLS
| Downloads the image
| 443

|===

[#network-configuration-hive-mce]
== Additional networking requirements when installing using the Hive Operator

When you are installing bare metal managed clusters with the Hive Operator, which includes using Central Infrastructure Management, you must configure a layer 2 or layer 3 port connection between the hub cluster and the `libvirt` provisioning host. This connection to the provisioning host is required during the creation of a base metal cluster with Hive. See the following table for more information:

|===
| Direction | Protocol | Connection | Port (if specified)

| Hub cluster outbound and inbound to the `libvirt` provisioning host
| IP
| Connects the hub cluster, where the Hive operator is installed, to the `libvirt` provisioning host that serves as a bootstrap when creating the bare metal cluster
| 

|===

**Note:** These requirements only apply when installing, and are not required when upgrading clusters that were installed with Infrastructure Operator.

[#network-configuration-hosted-control-planes-mce]
=== Hosted control planes networking requirements (Technology Preview)

When you use hosted control planes, the `HypershiftDeployment` resource must have connectivity to the endpoints listed in the following table:

|===
| Direction | Connection | Port (if specified)

| Outbound
| {ocp-short} control-plane and worker nodes
| 

| Outbound
| For hosted clusters on Amazon Web Services only: Outbound connection to AWS API and S3 API
| 

| Outbound
| For hosted clusters on Microsoft Azure cloud services only: Outbound connection to Azure API
| 

| Outbound
| {ocp-short} image repositories that store the ISO images of the coreOS and the image registry for {ocp-short} pods
| 

|===
