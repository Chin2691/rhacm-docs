[#troubleshooting-klusterlet-with-degraded-conditions]
= Troubleshooting klusterlet with degraded conditions

The klusterlet degraded conditions can help to diagnose the status of klusterlet agents on managed cluster,
if a klusterlet is in the degraded condition, the klusterlet agents on managed cluster may have troubles.

[#symptom-klusterlet-is-in-the-degraded-condition]
== Symptom: Klusterlet is in the degraded condition

After deploying a klusterlet on managed cluster, the klusterlet `KlusterletRegistrationDegraded` or `KlusterletWorkDegraded`
condition with a status of _True_.

[#identifying-the-problem-klusterlet-is-in-the-degraded-condition]
== Identifying the problem: Klusterlet is in the degraded condition

. Run the following command on the managed cluster to view the klusterlet status:
+
----
kubectl get klusterlets klusterlet -oyaml
----

. Check the the klusterlet `KlusterletRegistrationDegraded` or `KlusterletWorkDegraded` condition.

[#resolving-the-problem-klusterlet-is-in-the-degraded-condition]
== Resolving the problem: Klusterlet is in the degraded condition

. If the `KlusterletRegistrationDegraded` condition with a status of _True_ and the condition reason is: _BootStrapSecretMissing_,
you need create a bootstrap secret on `open-cluster-management-agent` namespace.

. If the `KlusterletRegistrationDegraded` condition with a status of _True_ and the condition reason is: _BootstrapSecretError_,
or _BootstrapSecretUnauthorized_, this means the current bootstrap secret is invalid, you may delete recreate a valid bootstrap
secret on `open-cluster-management-agent` namespace.

. If the `KlusterletRegistrationDegraded` and `KlusterletWorkDegraded` with status of _True_ and the condition reason is
_HubKubeConfigSecretMissing_, you may delete the klusterlet and recreate it.

. If the `KlusterletRegistrationDegraded` and `KlusterletWorkDegraded` with status of _True_ and the condition reason is:
_ClusterNameMissing_, _KubeConfigMissing_, _HubConfigSecretError_, _HubConfigSecretUnauthorized_, you may delete the hub kubeconfig
secret from `open-cluster-management-agent` namespace, if you delete the hub kubeconfig secret, the registration agent will
bootstrap again to get a new hub kubecofnig secret.

. If the `KlusterletRegistrationDegraded` with a status of _True_ and the condition reason is: _GetRegistrationDeploymentFailed_
or _UnavailableRegistrationPod_, you can check the condition message to get the problem details and resolve any problems.

. If the `KlusterletWorkDegraded` with status of _True_ and the condition reason is: _GetWorkDeploymentFailed_ or _UnavailableWorkPod_,
you can check the condition message to get the problem details and resolve any problems.
